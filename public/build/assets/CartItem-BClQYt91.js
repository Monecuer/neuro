import{j as r,r as u,c as A,S as z,R as B}from"./app-J0J4XT7Q.js";import{D as O}from"./Delete-NcfILLQ3.js";import W from"./QuantityInput-ICBD-mNb.js";import H from"./CartItemModal-DNbxAvCb.js";import{u as J}from"./SalesContext-B1jwJFA9.js";import{p as Q}from"./product-placeholder-DL4NWfZp.js";import{u as X}from"./currencyFormatter-DOmpFJHz.js";import{L as Y}from"./List-CA8Dfjeu.js";import{L as $}from"./ListItem-BIq8gZj4.js";import{c as M}from"./clsx-B-dksMZM.js";import{L as G}from"./ListContext-BTargF9Z.js";import{a as _,g as L,u as R,s as j,c as P,m as K}from"./memoTheme-BNdxtxoW.js";import{c as V}from"./createSvgIcon-DH-b1jMs.js";import{u as k}from"./useSlot-DIICVg-0.js";import{L as Z}from"./ListItemText-DbBV3q1i.js";import{T as w}from"./Typography-CWhVrPo-.js";import{B as tt}from"./Box-m8-AwHvJ.js";import{I as rt}from"./IconButton-CxCxJBhO.js";import{D as ot}from"./Divider-CCoppV9R.js";import{M as et}from"./TextField-B8xGzqYR.js";import{M as F}from"./MenuItem-D4ZeVUNG.js";import"./app-CxSMgHDY.js";import"./Add-B7dNfvFo.js";import"./index-BPJnJB5S.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./useId-bmtMxKKl.js";import"./ButtonBase-ah7Qb79a.js";import"./useTimeout-ijO9WPjY.js";import"./TransitionGroupContext-CUmnvxwJ.js";import"./emotion-react.browser.esm-BQ7e9N_g.js";import"./useForkRef-npmdbavI.js";import"./CircularProgress-Bcsy1Pin.js";import"./Close-CE33o-VC.js";import"./Visibility-B1KEDVr-.js";import"./Commission-DZY4pu8n.js";import"./Grid-ByMND7DF.js";import"./useTheme-CwSUTWIJ.js";import"./useThemeProps-ChzuPIZh.js";import"./extendSxProp-CT-SW93I.js";import"./isMuiElement-glFYcxXS.js";import"./InputAdornment-8bA6TaeC.js";import"./useFormControl-bsSDraOa.js";import"./index-i2kla6Uj.js";import"./ownerWindow-HkKU3E4x.js";import"./ownerDocument-DW-IO8s5.js";import"./debounce-Be36O1Ab.js";import"./index-DKn53RoO.js";import"./useSlotProps-BwjvMvhT.js";import"./Paper-CavyNtF_.js";import"./Grow-Bu5k9bsZ.js";import"./Portal-CVCC_lll.js";import"./index-FrVc2Q_M.js";import"./mergeSlotProps-D_PRovB-.js";import"./Modal-r73ew4B0.js";import"./useControlled-CIU3udus.js";import"./DialogContent-BvzB3xZG.js";import"./DialogTitle-2KN-Cgy_.js";import"./Chip-rj_j5-pw.js";import"./Alert-Cg00dAYx.js";import"./Close-0jcZMw1s.js";import"./DialogActions-3_XUqu2a.js";import"./Button-Bhgpz3NQ.js";import"./numeral-3Q0ULTA-.js";import"./listItemTextClasses-BS0z-cUj.js";import"./dividerClasses-C03W2_nD.js";import"./listItemIconClasses-CtCHhvqe.js";const at=V(r.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}));function st(t){return _("MuiAvatar",t)}L("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const nt=t=>{const{classes:e,variant:a,colorDefault:n}=t;return P({root:["root",a,n&&"colorDefault"],img:["img"],fallback:["fallback"]},st,e)},it=j("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:a}=t;return[e.root,e[a.variant],a.colorDefault&&e.colorDefault]}})(K(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:{color:(t.vars||t).palette.background.default,...t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:{backgroundColor:t.palette.grey[400],...t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})}}}]}))),lt=j("img",{name:"MuiAvatar",slot:"Img"})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),ct=j(at,{name:"MuiAvatar",slot:"Fallback"})({width:"75%",height:"75%"});function mt({crossOrigin:t,referrerPolicy:e,src:a,srcSet:n}){const[l,c]=u.useState(!1);return u.useEffect(()=>{if(!a&&!n)return;c(!1);let p=!0;const s=new Image;return s.onload=()=>{p&&c("loaded")},s.onerror=()=>{p&&c("error")},s.crossOrigin=t,s.referrerPolicy=e,s.src=a,n&&(s.srcset=n),()=>{p=!1}},[t,e,a,n]),l}const pt=u.forwardRef(function(e,a){const n=R({props:e,name:"MuiAvatar"}),{alt:l,children:c,className:p,component:s="div",slots:x={},slotProps:f={},imgProps:I,sizes:y,src:v,srcSet:h,variant:b="circular",...S}=n;let g=null;const m={...n,component:s,variant:b},C=mt({...I,...typeof f.img=="function"?f.img(m):f.img,src:v,srcSet:h}),o=v||h,i=o&&C!=="error";m.colorDefault=!i,delete m.ownerState;const d=nt(m),[D,N]=k("root",{ref:a,className:M(d.root,p),elementType:it,externalForwardedProps:{slots:x,slotProps:f,component:s,...S},ownerState:m}),[T,E]=k("img",{className:d.img,elementType:lt,externalForwardedProps:{slots:x,slotProps:{img:{...I,...f.img}}},additionalProps:{alt:l,src:v,srcSet:h,sizes:y},ownerState:m}),[q,U]=k("fallback",{className:d.fallback,elementType:ct,externalForwardedProps:{slots:x,slotProps:f},shouldForwardComponentProp:!0,ownerState:m});return i?g=r.jsx(T,{...E}):c||c===0?g=c:o&&l?g=l[0]:g=r.jsx(q,{...U}),r.jsx(D,{...N,children:g})});function dt(t){return _("MuiListItemAvatar",t)}L("MuiListItemAvatar",["root","alignItemsFlexStart"]);const ut=t=>{const{alignItems:e,classes:a}=t;return P({root:["root",e==="flex-start"&&"alignItemsFlexStart"]},dt,a)},ft=j("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:a}=t;return[e.root,a.alignItems==="flex-start"&&e.alignItemsFlexStart]}})({minWidth:56,flexShrink:0,variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}),xt=u.forwardRef(function(e,a){const n=R({props:e,name:"MuiListItemAvatar"}),{className:l,...c}=n,p=u.useContext(G),s={...n,alignItems:p.alignItems},x=ut(s);return r.jsx(ft,{className:M(x.root,l),ownerState:s,ref:a,...c})});function Fr(){const t=X();A().props.return_sale;const e=A().props.edit_sale,a=A().props.sale_data,{cartState:n,removeFromCart:l,emptyCart:c,emptyCartItemsOnly:p,addToCart:s}=J(),{setCartItemModalOpen:x,setSelectedCartItem:f,cartItemModalOpen:I}=u.useContext(z),[y,v]=u.useState(null),[h,b]=u.useState(null),S=!!y,g=(o,i)=>{v(o.currentTarget),b(i)},m=()=>{v(null)},C=(o,i)=>{if(i==="free"){const d={...o,price:0,cost:0,add_new_item:!0,quantity:1,is_free:!0};s(d)}else if(i==="duplicate"){const d={...o,add_new_item:!0};s(d)}m()};return u.useEffect(()=>{e&&a?.cart_snapshot&&(p(),JSON.parse(a.cart_snapshot).forEach(i=>{s(i,i.quantity)}))},[e,a?.cart_snapshot]),r.jsxs(Y,{sx:{width:"100%",bgcolor:"background.paper"},children:[n.map((o,i)=>r.jsxs(B.Fragment,{children:[r.jsxs($,{alignItems:"center",sx:{padding:{sm:.5,xs:0},paddingY:.5},children:[r.jsx(xt,{onClick:d=>g(d,o),className:"cursor-pointer",children:r.jsx(pt,{variant:"rounded",sx:{width:50,height:50},alt:o.name,src:o.image_url?o.image_url:Q})}),r.jsx(Z,{primary:r.jsx(w,{component:"h5",sx:{fontWeight:"bold",cursor:"pointer",fontSize:{sm:"1rem",xs:"0.9rem"}},className:"hover:underline",onClick:()=>{f({...o,cart_index:i}),x(!0)},children:o.name}),sx:{ml:"10px"},secondary:r.jsx(r.Fragment,{children:r.jsxs(w,{component:"span",variant:"body2",sx:{color:"text.primary",display:"inline"},children:[(o.price-o.discount)*o.quantity===0?r.jsx("span",{className:"bg-green-600 text-white px-2 py-1 rounded-md",children:"Free"}):r.jsxs(r.Fragment,{children:[t(o.price-o.discount,!1)," X ",o.quantity," = ",r.jsxs("b",{children:[t((o.price-o.discount)*o.quantity,!1),o.flat_discount>0&&" - "+t(o.flat_discount,!1)]})]}),r.jsx("br",{})]})})}),r.jsx(tt,{className:"flex flex-row",children:r.jsxs("div",{className:"relative w-full flex flex-row",children:[r.jsx(W,{cartItem:{...o,cart_index:i}}),r.jsx(rt,{"aria-label":"delete",color:"error",sx:{ml:"8px"},onClick:()=>l(i),children:r.jsx(O,{})})]})})]}),r.jsx(ot,{variant:"inset",component:"li"}),r.jsxs(et,{id:"cart-menu",anchorEl:y,open:S,onClose:m,slotProps:{list:{"aria-labelledby":"basic-button"}},children:[r.jsx(F,{onClick:()=>C(h,"free"),children:"ADD FREE ITEMS"}),r.jsx(F,{onClick:()=>C(h,"duplicate"),children:"DUPLICATE"})]})]},i)),I&&r.jsx(H,{})]})}export{Fr as default};
