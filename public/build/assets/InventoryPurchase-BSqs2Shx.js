import{r as x,j as t,d as R,H as q,a as T,b as W}from"./app-J0J4XT7Q.js";import{A as M}from"./AuthenticatedLayout-CV1_pG3T.js";import{A as w}from"./AddCircle--eDjuMLx.js";import{D as z}from"./Delete-NcfILLQ3.js";import{S as _}from"./sweetalert2.esm.all-5zhdP7Ax.js";import{n as S}from"./numeral-3Q0ULTA-.js";import A from"./InventoryItemDialog-DGlQB-cX.js";import{G as u}from"./Grid-ByMND7DF.js";import{T as h}from"./TextField-B8xGzqYR.js";import{M as B}from"./MenuItem-D4ZeVUNG.js";import{B as I}from"./Button-Bhgpz3NQ.js";import{T as D}from"./TableContainer-BQBwiHL3.js";import{P as E}from"./Paper-CavyNtF_.js";import{T as L,a as g,b as O}from"./TableRow-KnMNmPIP.js";import{T as U}from"./TableHead-khwUWmBh.js";import{a as k,T as i}from"./TableCell-CmCRc8xm.js";import{A as Y}from"./Autocomplete-tKHD7bsB.js";import{I as H}from"./InputAdornment-8bA6TaeC.js";import{I as V}from"./IconButton-CxCxJBhO.js";import{c as G}from"./clsx-B-dksMZM.js";import{a as Q,g as J,u as K,s as X,c as Z}from"./memoTheme-BNdxtxoW.js";import{B as $}from"./Box-m8-AwHvJ.js";import"./app-CxSMgHDY.js";import"./createSvgIcon-DH-b1jMs.js";import"./Payments-C74n1UUC.js";import"./Receipt-CfgyI0Rt.js";import"./index-BOh9Hbob.js";import"./index-B49xHE6m.js";import"./infoshop-CyNm3vmK.js";import"./Toolbar-Bt5N0HeY.js";import"./Divider-CCoppV9R.js";import"./dividerClasses-C03W2_nD.js";import"./List-CA8Dfjeu.js";import"./ListContext-BTargF9Z.js";import"./ListItemButton-ChmwJdM0.js";import"./ListItemText-DbBV3q1i.js";import"./listItemTextClasses-BS0z-cUj.js";import"./useSlot-DIICVg-0.js";import"./useForkRef-npmdbavI.js";import"./Typography-CWhVrPo-.js";import"./index-i2kla6Uj.js";import"./extendSxProp-CT-SW93I.js";import"./useTheme-CwSUTWIJ.js";import"./emotion-react.browser.esm-BQ7e9N_g.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./TransitionGroupContext-CUmnvxwJ.js";import"./ButtonBase-ah7Qb79a.js";import"./useTimeout-ijO9WPjY.js";import"./listItemIconClasses-CtCHhvqe.js";import"./Collapse-CMBVb5gg.js";import"./Portal-CVCC_lll.js";import"./index-FrVc2Q_M.js";import"./CssBaseline-BPSh959V.js";import"./AppBar-BfAA5r0X.js";import"./Tooltip-CQRdrBam.js";import"./index-DKn53RoO.js";import"./useControlled-CIU3udus.js";import"./useId-bmtMxKKl.js";import"./Grow-Bu5k9bsZ.js";import"./Popper-DhnmPy4J.js";import"./ownerDocument-DW-IO8s5.js";import"./useSlotProps-BwjvMvhT.js";import"./Drawer-BUnkvJCp.js";import"./mergeSlotProps-D_PRovB-.js";import"./debounce-Be36O1Ab.js";import"./ownerWindow-HkKU3E4x.js";import"./Modal-r73ew4B0.js";import"./ListItem-BIq8gZj4.js";import"./isMuiElement-glFYcxXS.js";import"./Close-CE33o-VC.js";import"./DialogContent-BvzB3xZG.js";import"./DialogTitle-2KN-Cgy_.js";import"./DialogActions-3_XUqu2a.js";import"./index-BPJnJB5S.js";import"./CircularProgress-Bcsy1Pin.js";import"./useThemeProps-ChzuPIZh.js";import"./useFormControl-bsSDraOa.js";import"./Close-0jcZMw1s.js";import"./usePreviousProps-BagdRM8M.js";import"./Chip-rj_j5-pw.js";function tt(l){return Q("MuiTableFooter",l)}J("MuiTableFooter",["root"]);const et=l=>{const{classes:m}=l;return Z({root:["root"]},tt,m)},ot=X("tfoot",{name:"MuiTableFooter",slot:"Root"})({display:"table-footer-group"}),rt={variant:"footer"},F="tfoot",it=x.forwardRef(function(m,f){const j=K({props:m,name:"MuiTableFooter"}),{className:y,component:p=F,...a}=j,c={...j,component:p},v=et(c);return t.jsx(k.Provider,{value:rt,children:t.jsx(ot,{as:p,className:G(v.root,y),ref:f,role:p===F?null:"rowgroup",ownerState:c,...a})})}),We=({inventory_items:l,stores:m})=>{const[f,j]=x.useState(l),[y,p]=x.useState(!1),[a,c]=x.useState({store_id:1,transaction_date:R().format("YYYY-MM-DD")}),v=o=>{const r={preserveState:!0,preserveScroll:!0,only:["inventory_items"],onSuccess:e=>{j(e.props.inventory_items)}};T.get(o,[],r)},[n,b]=x.useState([{item:null,quantity:"",unitCost:""}]),C=(o,r,e)=>{const s=[...n];s[o][r]=e,b(s);const d=s[s.length-1];d.item&&d.quantity&&d.unitCost&&b([...s,{item:null,quantity:"",unitCost:""}])},N=o=>{const r=n.filter((e,s)=>s!==o);b(r.length?r:[{item:null,quantity:"",unitCost:""}])},P=()=>{if(!n.every(e=>e.item!==null&&e.quantity!==""&&e.unitCost!=="")){_.fire({title:"Error!",text:"Please fill in all the fields",icon:"error",showConfirmButton:!1,timer:2e3,timerProgressBar:!0});return}const r=new FormData;r.append("store_id",a.store_id),r.append("transaction_date",a.transaction_date),r.append("items",JSON.stringify(n)),r.append("total",n.reduce((e,s)=>e+s.unitCost*s.quantity,0)),W.post("/inventory-purchase",r).then(e=>{_.fire({title:"Success!",text:e.data.message,icon:"success",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),location.reload()}).catch(e=>{console.error("Submission failed with errors:",e)})};return t.jsxs(M,{children:[t.jsx(q,{title:"Inventory Purchase"}),t.jsxs(u,{container:!0,spacing:2,alignItems:"center",sx:{width:"100%"},size:12,children:[t.jsx(u,{size:3,children:t.jsx(h,{fullWidth:!0,label:"Store",variant:"outlined",select:!0,size:"large",name:"store_id",value:a.store_id,onChange:o=>c({...a,store_id:o.target.value}),children:m.map(o=>t.jsx(B,{value:o.id,children:o.name},o.id))})}),t.jsx(u,{size:3,children:t.jsx(h,{fullWidth:!0,label:"Purchase Date",variant:"outlined",name:"transaction_date",type:"date",size:"large",value:a.transaction_date,onChange:o=>c({...a,transaction_date:o.target.value}),slotProps:{inputLabel:{shrink:!0}}})}),t.jsx(u,{size:{xs:4,sm:6,md:3},children:t.jsx(I,{variant:"contained",sx:{height:"100%"},startIcon:t.jsx(w,{}),size:"large",fullWidth:!0,color:"success",onClick:()=>{p(!0)},children:"NEW INVENTORY ITEM"})})]}),t.jsx(u,{container:!0,spacing:2,sx:{mt:2},children:t.jsx(D,{component:E,sx:{mt:2},children:t.jsxs(L,{children:[t.jsx(U,{children:t.jsxs(g,{children:[t.jsx(i,{sx:{fontWeight:"bold"},children:"Inventory Item"}),t.jsx(i,{sx:{fontWeight:"bold"},children:"Unit Cost"}),t.jsx(i,{sx:{fontWeight:"bold"},children:"Quantity"}),t.jsx(i,{sx:{fontWeight:"bold"},children:"Line Total"}),t.jsx(i,{sx:{fontWeight:"bold"},children:"Action"})]})}),t.jsx(O,{children:n.map((o,r)=>t.jsxs(g,{children:[t.jsx(i,{children:t.jsx(Y,{options:f.filter(e=>!n.some((s,d)=>d!==r&&s.item?.id===e.id)||o.item?.id===e.id),getOptionLabel:e=>e.name,getOptionKey:e=>e.id,value:o.item,onChange:(e,s)=>C(r,"item",s),renderInput:e=>t.jsx(h,{...e,size:"large",fullWidth:!0})})}),t.jsx(i,{width:200,children:t.jsx(h,{fullWidth:!0,size:"large",type:"number",required:!0,placeholder:"Unit Cost",value:o.unitCost,onChange:e=>C(r,"unitCost",e.target.value)})}),t.jsx(i,{width:200,children:t.jsx(h,{fullWidth:!0,size:"large",type:"number",placeholder:"Quantity",value:o.quantity,onChange:e=>C(r,"quantity",e.target.value),required:!0,slotProps:{input:{endAdornment:t.jsx(H,{position:"end",className:"text-sm italic",children:o.item?.unit_type})}}})}),t.jsx(i,{children:t.jsxs("strong",{children:[" ",S(o.quantity*o.unitCost).format("0,0.00")]})}),t.jsx(i,{children:n.length>1&&t.jsx(V,{onClick:()=>N(r),children:t.jsx(z,{color:"error"})})})]},r))}),t.jsxs(it,{children:[t.jsxs(g,{children:[t.jsx(i,{}),t.jsx(i,{}),t.jsx(i,{align:"right",children:t.jsx("span",{className:"font-bold text-lg",children:"Total"})}),t.jsx(i,{children:t.jsx("span",{className:"font-bold text-lg",children:S(n.reduce((o,r)=>o+Number(r.quantity||0)*Number(r.unitCost||0),0)).format("0,0.00")})})]}),t.jsx(g,{children:t.jsxs(i,{align:"right",colSpan:5,children:[t.jsx(I,{variant:"contained",color:"error",onClick:()=>T.get("/inventory"),sx:{mr:2},children:"CANCEL"}),t.jsx(I,{variant:"contained",color:"primary",onClick:()=>{P()},children:"Submit"})]})})]})]})})}),t.jsx($,{className:"py-6 w-full",sx:{display:"grid",gridTemplateColumns:"1fr",height:"calc(100vh - 200px)"}}),t.jsx(A,{open:y,setOpen:p,inventory_item:null,stores:m,refreshInventoryItems:v})]})};export{We as default};
