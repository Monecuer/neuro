import{r as x,j as r,a as F}from"./app-J0J4XT7Q.js";import{S as h}from"./sweetalert2.esm.all-5zhdP7Ax.js";import{D as S,a as y}from"./DialogContent-BvzB3xZG.js";import{D}from"./DialogTitle-2KN-Cgy_.js";import{f as v,T as b}from"./TextField-B8xGzqYR.js";import{c as G}from"./clsx-B-dksMZM.js";import{a as P,g as R,u as U,s as M,c as B}from"./memoTheme-BNdxtxoW.js";import{u as E}from"./useFormControl-bsSDraOa.js";import{G as g}from"./Grid-ByMND7DF.js";import{F as T}from"./FormControlLabel-BrfCEOZg.js";import{S as W}from"./Switch-Cdhpx7n_.js";import{D as k}from"./DialogActions-3_XUqu2a.js";import{B as j}from"./Button-Bhgpz3NQ.js";import"./app-CxSMgHDY.js";import"./useTheme-CwSUTWIJ.js";import"./useSlot-DIICVg-0.js";import"./useForkRef-npmdbavI.js";import"./Paper-CavyNtF_.js";import"./Modal-r73ew4B0.js";import"./ownerWindow-HkKU3E4x.js";import"./ownerDocument-DW-IO8s5.js";import"./TransitionGroupContext-CUmnvxwJ.js";import"./Portal-CVCC_lll.js";import"./index-FrVc2Q_M.js";import"./useId-bmtMxKKl.js";import"./Typography-CWhVrPo-.js";import"./index-i2kla6Uj.js";import"./extendSxProp-CT-SW93I.js";import"./emotion-react.browser.esm-BQ7e9N_g.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./debounce-Be36O1Ab.js";import"./index-DKn53RoO.js";import"./useSlotProps-BwjvMvhT.js";import"./Grow-Bu5k9bsZ.js";import"./useTimeout-ijO9WPjY.js";import"./mergeSlotProps-D_PRovB-.js";import"./List-CA8Dfjeu.js";import"./ListContext-BTargF9Z.js";import"./useControlled-CIU3udus.js";import"./createSvgIcon-DH-b1jMs.js";import"./isMuiElement-glFYcxXS.js";import"./index-BPJnJB5S.js";import"./useThemeProps-ChzuPIZh.js";import"./SwitchBase-BD-arTUS.js";import"./ButtonBase-ah7Qb79a.js";import"./CircularProgress-Bcsy1Pin.js";function q(n){return P("MuiFormGroup",n)}R("MuiFormGroup",["root","row","error"]);const A=n=>{const{classes:t,row:s,error:e}=n;return B({root:["root",s&&"row",e&&"error"]},q,t)},N=M("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(n,t)=>{const{ownerState:s}=n;return[t.root,s.row&&t.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),_=x.forwardRef(function(t,s){const e=U({props:t,name:"MuiFormGroup"}),{className:a,row:c=!1,...u}=e,d=E(),f=v({props:e,muiFormControl:d,states:["error"]}),l={...e,row:c,error:f.error},o=A(l);return r.jsx(N,{className:G(o.root,a),ownerState:l,ref:s,...u})});function Er({open:n,handleClose:t,user_role:s}){const[e,a]=x.useState({user_role:"",permissions:[]}),c=["pos","products","inventory","sales","customers","vendors","charges","collections","expenses","quotations","reloads","cheques","sold-items","purchases","payments","stores","employees","payroll","media","settings"];x.useEffect(()=>{a(s?{user_role:s.name||"",permissions:s.permissions?.map(o=>o.name)||[]}:{user_role:"",permissions:[]})},[s]);const u=o=>{const{name:m,value:p}=o.target;a(i=>({...i,[m]:p}))},d=o=>{const{value:m,checked:p}=o.target;a(i=>{const w=p?[...i.permissions,m]:i.permissions.filter(C=>C!==m);return{...i,permissions:w}})},f=o=>{o.preventDefault();const m=s?`/user/${s.id}/role`:"/user/role";F.post(m,e,{onSuccess:p=>{const i=p.props.flash?.message||"User role and permissions updated!";h.fire({title:"Success!",text:i,icon:"success",position:"bottom-start",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,toast:!0}),t()},onError:p=>{const i=Object.values(p).flat().join(" | ");h.fire({title:"Error!",text:i||"An unexpected error occurred.",icon:"error",confirmButtonText:"OK",timerProgressBar:!0})}})},l=window.innerWidth<768;return r.jsxs(S,{open:n,onClose:t,maxWidth:"sm",fullWidth:!0,PaperProps:{component:"form",onSubmit:f},fullScreen:l,children:[r.jsx(D,{children:"User Role and Permissions"}),r.jsxs(y,{children:[r.jsx(b,{className:"py-8",required:!0,margin:"dense",id:"user_role",name:"user_role",label:"User Role",type:"text",fullWidth:!0,variant:"outlined",value:e.user_role,onChange:u,disabled:e.user_role==="admin"||e.user_role==="super-admin"}),r.jsxs(_,{sx:{mt:"1rem"},children:[r.jsx("h4",{children:"Permissions"}),r.jsx(g,{container:!0,spacing:2,children:c.map((o,m)=>r.jsx(g,{size:{xs:6,sm:4},children:r.jsx(T,{sx:{textTransform:"capitalize"},control:r.jsx(W,{checked:e.permissions.includes(o),onChange:d,value:o,name:"permissions"}),label:o})},m))})]})]}),r.jsxs(k,{children:[r.jsx(j,{onClick:t,children:"Cancel"}),r.jsx(j,{type:"submit",children:"SAVE"})]})]})}export{Er as default};
