import{j as t,r as i,H as B,a as F,L as m}from"./app-J0J4XT7Q.js";import{A as L}from"./AuthenticatedLayout-CV1_pG3T.js";import{A as M}from"./Add-B7dNfvFo.js";import{P as k}from"./Print-CRehaXOr.js";import{c as y}from"./createSvgIcon-DH-b1jMs.js";import{n as N}from"./numeral-3Q0ULTA-.js";import O from"./FormDialog-Cw_mpDmK.js";import{C as V}from"./CustomPagination-CkAVOvIV.js";import{A as q}from"./AddPaymentDialog-DUHxG7MF.js";import{P as H}from"./Payments-C74n1UUC.js";import{u as R}from"./index-BCKQ-IUm.js";import G from"./MobileContactsList-Dhi-cZwB.js";import"./SalesContext-B1jwJFA9.js";import{u as W}from"./useTheme-CwSUTWIJ.js";import{G as n}from"./Grid-ByMND7DF.js";import{T as $}from"./TextField-B8xGzqYR.js";import{B as b}from"./Button-Bhgpz3NQ.js";import{B as Q}from"./Box-m8-AwHvJ.js";import{T as p}from"./Tooltip-CQRdrBam.js";import{I as h}from"./IconButton-CxCxJBhO.js";import{D as U}from"./DataGrid-DGSyaMP7.js";import"./app-CxSMgHDY.js";import"./Receipt-CfgyI0Rt.js";import"./index-BOh9Hbob.js";import"./index-B49xHE6m.js";import"./infoshop-CyNm3vmK.js";import"./Toolbar-Bt5N0HeY.js";import"./clsx-B-dksMZM.js";import"./memoTheme-BNdxtxoW.js";import"./index-BPJnJB5S.js";import"./Divider-CCoppV9R.js";import"./dividerClasses-C03W2_nD.js";import"./List-CA8Dfjeu.js";import"./ListContext-BTargF9Z.js";import"./ListItemButton-ChmwJdM0.js";import"./ListItemText-DbBV3q1i.js";import"./listItemTextClasses-BS0z-cUj.js";import"./useSlot-DIICVg-0.js";import"./useForkRef-npmdbavI.js";import"./Typography-CWhVrPo-.js";import"./index-i2kla6Uj.js";import"./extendSxProp-CT-SW93I.js";import"./emotion-react.browser.esm-BQ7e9N_g.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./TransitionGroupContext-CUmnvxwJ.js";import"./ButtonBase-ah7Qb79a.js";import"./useTimeout-ijO9WPjY.js";import"./listItemIconClasses-CtCHhvqe.js";import"./Collapse-CMBVb5gg.js";import"./Portal-CVCC_lll.js";import"./index-FrVc2Q_M.js";import"./CssBaseline-BPSh959V.js";import"./AppBar-BfAA5r0X.js";import"./Paper-CavyNtF_.js";import"./Drawer-BUnkvJCp.js";import"./index-DKn53RoO.js";import"./mergeSlotProps-D_PRovB-.js";import"./debounce-Be36O1Ab.js";import"./ownerWindow-HkKU3E4x.js";import"./ownerDocument-DW-IO8s5.js";import"./Modal-r73ew4B0.js";import"./ListItem-BIq8gZj4.js";import"./isMuiElement-glFYcxXS.js";import"./sweetalert2.esm.all-5zhdP7Ax.js";import"./DialogContent-BvzB3xZG.js";import"./useId-bmtMxKKl.js";import"./DialogTitle-2KN-Cgy_.js";import"./DialogActions-3_XUqu2a.js";import"./useFormControl-bsSDraOa.js";import"./useSlotProps-BwjvMvhT.js";import"./Grow-Bu5k9bsZ.js";import"./useControlled-CIU3udus.js";import"./CircularProgress-Bcsy1Pin.js";import"./select-DyvmpJZN.js";import"./floating-ui.dom-CpMS8hwT.js";import"./tslib.es6-BUas5LQb.js";import"./utils-NikRBbYi.js";import"./chevron-down-CG2MU_w-.js";import"./createLucideIcon-CMxlCnxM.js";import"./chevron-right-Bo1euGMr.js";import"./Close-CE33o-VC.js";import"./InputAdornment-8bA6TaeC.js";import"./MenuItem-D4ZeVUNG.js";import"./useThemeProps-ChzuPIZh.js";import"./index-ZjJBU8Ce.js";import"./printer-DiRWJKnw.js";import"./Popper-DhnmPy4J.js";import"./index-COpDpgvE.js";import"./with-selector-DrGGaYor.js";import"./toPropertyKey-C9c9JG92.js";import"./Switch-Cdhpx7n_.js";import"./SwitchBase-BD-arTUS.js";import"./Chip-rj_j5-pw.js";import"./Badge-Ce_dt518.js";import"./usePreviousProps-BagdRM8M.js";import"./Autocomplete-tKHD7bsB.js";import"./Close-0jcZMw1s.js";import"./FormControlLabel-BrfCEOZg.js";import"./KeyboardArrowRight-CSUedYIP.js";import"./TableCell-CmCRc8xm.js";import"./Checkbox-JPk1Ur6h.js";const Y=y(t.jsx("path",{d:"m6 2 .01 6L10 12l-3.99 4.01L6 22h12v-6l-4-4 4-3.99V2zm10 14.5V20H8v-3.5l4-4z"})),J=y(t.jsx("path",{d:"M17 12c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m1.65 7.35L16.5 17.2V14h1v2.79l1.85 1.85zM18 3h-3.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H6c-1.1 0-2 .9-2 2v15c0 1.1.9 2 2 2h6.11c-.59-.57-1.07-1.25-1.42-2H6V5h2v3h8V5h2v5.08c.71.1 1.38.31 2 .6V5c0-1.1-.9-2-2-2m-6 2c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"})),K=l=>[{field:"id",headerName:"ID",width:80},{field:"name",headerName:"Name",width:200,renderCell:e=>t.jsx(m,{underline:"hover",href:"#",className:"hover:underline",onClick:s=>{s.preventDefault(),l(e.row,"contact_edit")},children:t.jsx("p",{className:"font-bold",children:e.value})})},{field:"balance",headerName:"Balance",width:160,valueGetter:e=>parseFloat(e),renderCell:e=>t.jsx(b,{onClick:()=>l(e.row,"add_payment"),variant:"text",fullWidth:!0,sx:{textAlign:"left",fontWeight:"bold",justifyContent:"flex-end"},children:N(e.value).format("0,00.00")})},{field:"phone",headerName:"Phone",width:120},{field:"whatsapp",headerName:"Whatsapp",width:120},{field:"email",headerName:"Email",width:100},{field:"address",headerName:"Address",width:200},{field:"created_at",headerName:"Created At",width:100},{field:"action",headerName:"Actions",width:180,renderCell:e=>{const s=e.row.type==="vendor"?"/purchases":"/sales";return e.row.type,t.jsxs(t.Fragment,{children:[t.jsx(m,{href:"/reports/"+e.row.id+"/"+e.row.type,children:t.jsx(p,{title:"REPORT",children:t.jsx(h,{color:"primary",children:t.jsx(k,{})})})}),e.row.type==="customer"&&t.jsx(m,{href:"/pending-sales-receipt/"+e.row.id,children:t.jsx(p,{title:"PENDING RECEIPT",children:t.jsx(h,{color:"primary",children:t.jsx(J,{})})})}),t.jsx(m,{href:`${s}?contact_id=${e.row.id}&end_date=&query=&start_date=&status=pending&store=0`,children:t.jsx(p,{title:"CREDIT SALE",children:t.jsx(h,{color:"alert",children:t.jsx(Y,{})})})}),t.jsx(m,{href:`/payments${s}?contact_id=${e.row.id}&store=0`,children:t.jsx(p,{title:"PAYMENTS",children:t.jsx(h,{color:"success",children:t.jsx(H,{})})})})]})}}];function We({contacts:l,type:e,stores:s}){const[S,u]=i.useState(!1),[j,f]=i.useState(null),[_,w]=i.useState(!1),[a,T]=i.useState(l),[I,P]=i.useState(0),A=W(),C=R(A.breakpoints.down("sm")),[c,v]=i.useState({per_page:100,search_query:""}),E=()=>{f(null),u(!0)},g=(r,o)=>{f(r),o=="contact_edit"?u(!0):o=="add_payment"&&w(!0)},z=()=>{f(null),u(!1)},d=r=>{const o={preserveState:!0,preserveScroll:!0,only:["contacts"],onSuccess:x=>{T(x.props.contacts)}};F.get(r,{...c},o)};i.useEffect(()=>{d(window.location.pathname)},[c]);const D=r=>{d(window.location.pathname)};return i.useEffect(()=>{if(a){const r=Object.values(a.data).reduce((o,x)=>o+parseFloat(x.balance),0);P(r)}},[a]),t.jsxs(L,{children:[t.jsx(B,{title:e[0].toUpperCase()+e.slice(1)+"s"}),t.jsxs(n,{container:!0,spacing:2,alignItems:"center",sx:{width:"100%"},children:[t.jsx(n,{size:{xs:12,sm:2,md:3},children:t.jsx("div",{className:"bg-red-200 p-4 rounded text-red-950 text-sm",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{children:"Balance:"})," ",t.jsx("div",{className:"font-bold",children:N(I).format("0,00.00")})]})})}),t.jsxs(n,{size:{xs:12,sm:10,md:9},spacing:2,container:!0,justifyContent:"end",alignItems:"center",flexDirection:{xs:"column",sm:"row"},children:[t.jsx(n,{size:{xs:12,sm:8},children:t.jsx($,{name:"search_query",label:"Search",variant:"outlined",size:"small",value:c?.search_query,onChange:r=>v(o=>({...o,search_query:r.target.value})),required:!0,fullWidth:!0,onFocus:r=>{r.target.select()},slotProps:{inputLabel:{shrink:!0}}})}),t.jsx(n,{size:{xs:12,sm:3},children:t.jsxs(b,{variant:"contained",startIcon:t.jsx(M,{}),onClick:E,fullWidth:!0,size:"small",color:"success",children:["Add ",e[0].toUpperCase()+e.slice(1)]})})]}),!C&&t.jsx(Q,{className:"py-6 w-full",sx:{display:"grid",gridTemplateColumns:"1fr",height:"calc(100vh - 240px)"},children:t.jsx(U,{rows:a.data,columns:K(g),getRowId:r=>r.id,slotProps:{toolbar:{showQuickFilter:!0}},initialState:{columns:{columnVisibilityModel:{address:!1,email:!1,created_at:!1}}},hideFooter:!0})}),C&&t.jsx(G,{contacts:a.data,handleContactEdit:g}),t.jsx(n,{size:12,container:!0,justifyContent:"end",children:t.jsx(V,{refreshTable:d,setSearchTerms:v,searchTerms:c,data:a})})]}),t.jsx(O,{open:S,handleClose:z,contact:j,contactType:e,onSuccess:D}),t.jsx(q,{open:_,setOpen:w,selectedContact:j?.id,is_customer:e==="customer",stores:s,refreshTable:d})]})}export{We as default};
