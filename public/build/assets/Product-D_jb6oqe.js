import{j as t,c as F,r as o,H as W,L as p,a as V}from"./app-J0J4XT7Q.js";import{A as H}from"./AuthenticatedLayout-CV1_pG3T.js";import{A as Q}from"./Add-B7dNfvFo.js";import{c as w}from"./createSvgIcon-DH-b1jMs.js";import{H as D}from"./History-DUtImqYZ.js";import E from"./BatchModal-BkEMK8sR.js";import G from"./QuantityModal-WOghs5FG.js";import{C as $}from"./CustomPagination-CkAVOvIV.js";import{n as x}from"./numeral-3Q0ULTA-.js";import{S as R}from"./react-select.esm-DYJLO2tl.js";import{u as K}from"./index-BCKQ-IUm.js";import{P as U,B as J}from"./ProductsList-DtCDL8tp.js";import{u as X}from"./useTheme-CwSUTWIJ.js";import{G as a}from"./Grid-ByMND7DF.js";import{T as f}from"./TextField-B8xGzqYR.js";import{M as d}from"./MenuItem-D4ZeVUNG.js";import{B as b}from"./Button-Bhgpz3NQ.js";import{B as g}from"./Box-m8-AwHvJ.js";import{C as I}from"./Chip-rj_j5-pw.js";import{D as Y}from"./DataGrid-DGSyaMP7.js";import"./app-CxSMgHDY.js";import"./Payments-C74n1UUC.js";import"./Receipt-CfgyI0Rt.js";import"./index-BOh9Hbob.js";import"./index-B49xHE6m.js";import"./infoshop-CyNm3vmK.js";import"./Toolbar-Bt5N0HeY.js";import"./clsx-B-dksMZM.js";import"./memoTheme-BNdxtxoW.js";import"./index-BPJnJB5S.js";import"./Divider-CCoppV9R.js";import"./dividerClasses-C03W2_nD.js";import"./List-CA8Dfjeu.js";import"./ListContext-BTargF9Z.js";import"./ListItemButton-ChmwJdM0.js";import"./ListItemText-DbBV3q1i.js";import"./listItemTextClasses-BS0z-cUj.js";import"./useSlot-DIICVg-0.js";import"./useForkRef-npmdbavI.js";import"./Typography-CWhVrPo-.js";import"./index-i2kla6Uj.js";import"./extendSxProp-CT-SW93I.js";import"./emotion-react.browser.esm-BQ7e9N_g.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./TransitionGroupContext-CUmnvxwJ.js";import"./ButtonBase-ah7Qb79a.js";import"./useTimeout-ijO9WPjY.js";import"./listItemIconClasses-CtCHhvqe.js";import"./Collapse-CMBVb5gg.js";import"./Portal-CVCC_lll.js";import"./index-FrVc2Q_M.js";import"./CssBaseline-BPSh959V.js";import"./AppBar-BfAA5r0X.js";import"./Paper-CavyNtF_.js";import"./IconButton-CxCxJBhO.js";import"./useId-bmtMxKKl.js";import"./CircularProgress-Bcsy1Pin.js";import"./Tooltip-CQRdrBam.js";import"./index-DKn53RoO.js";import"./useControlled-CIU3udus.js";import"./Grow-Bu5k9bsZ.js";import"./Popper-DhnmPy4J.js";import"./ownerDocument-DW-IO8s5.js";import"./useSlotProps-BwjvMvhT.js";import"./Drawer-BUnkvJCp.js";import"./mergeSlotProps-D_PRovB-.js";import"./debounce-Be36O1Ab.js";import"./ownerWindow-HkKU3E4x.js";import"./Modal-r73ew4B0.js";import"./ListItem-BIq8gZj4.js";import"./isMuiElement-glFYcxXS.js";import"./Close-CE33o-VC.js";import"./sweetalert2.esm.all-5zhdP7Ax.js";import"./DialogContent-BvzB3xZG.js";import"./DialogTitle-2KN-Cgy_.js";import"./FormControlLabel-BrfCEOZg.js";import"./useFormControl-bsSDraOa.js";import"./Switch-Cdhpx7n_.js";import"./SwitchBase-BD-arTUS.js";import"./DialogActions-3_XUqu2a.js";import"./Select-ef7c0426.esm-ORlhB7cR.js";import"./toPropertyKey-C9c9JG92.js";import"./floating-ui.dom-CpMS8hwT.js";import"./useThemeProps-ChzuPIZh.js";import"./select-DyvmpJZN.js";import"./tslib.es6-BUas5LQb.js";import"./utils-NikRBbYi.js";import"./chevron-down-CG2MU_w-.js";import"./createLucideIcon-CMxlCnxM.js";import"./chevron-right-Bo1euGMr.js";import"./currencyFormatter-DOmpFJHz.js";import"./index-COpDpgvE.js";import"./with-selector-DrGGaYor.js";import"./Badge-Ce_dt518.js";import"./usePreviousProps-BagdRM8M.js";import"./Autocomplete-tKHD7bsB.js";import"./Close-0jcZMw1s.js";import"./KeyboardArrowRight-CSUedYIP.js";import"./TableCell-CmCRc8xm.js";import"./Checkbox-JPk1Ur6h.js";import"./InputAdornment-8bA6TaeC.js";const Z=w(t.jsx("path",{d:"M15 21h-2v-2h2zm-2-7h-2v5h2zm8-2h-2v4h2zm-2-2h-2v2h2zM7 12H5v2h2zm-2-2H3v2h2zm7-5h2V3h-2zm-7.5-.5v3h3v-3zM9 9H3V3h6zm-4.5 7.5v3h3v-3zM9 21H3v-6h6zm7.5-16.5v3h3v-3zM21 9h-6V3h6zm-2 10v-3h-4v2h2v3h4v-2zm-2-7h-4v2h4zm-4-2H7v2h2v2h2v-2h2zm1-1V7h-2V5h-2v4zM6.75 5.25h-1.5v1.5h1.5zm0 12h-1.5v1.5h1.5zm12-12h-1.5v1.5h1.5z"})),tt=w(t.jsx("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})),et=w(t.jsx("path",{d:"m22 9.24-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28z"})),rt=h=>[{field:"image_url",headerName:"Image",width:100,renderCell:r=>r.value?t.jsx("img",{src:r.value,style:{width:"75px",height:"51px",objectFit:"cover",padding:"5px",paddingBottom:"5px",paddingLeft:"0"},alt:"Product Image",loading:"lazy"}):t.jsx("span",{style:{width:"100%",height:"100%",objectFit:"cover",padding:"5px",paddingBottom:"5px",paddingLeft:"0"},className:"text-center",children:"No Image"})},{field:"name",headerName:"Product Name",width:200,renderCell:r=>t.jsx(p,{underline:"hover",className:"hover:underline",href:"/products/"+r.row.id+"/edit",children:t.jsx("p",{className:"font-bold",children:r.value})})},{field:"contact_name",headerName:"Supplier",width:100},{field:"barcode",headerName:"Barcode",width:170},{field:"batch_number",headerName:"Batch",width:120,renderCell:r=>t.jsx(b,{onClick:()=>h(r.row,"batch"),variant:"text",fullWidth:!0,sx:{textAlign:"left",fontWeight:"bold",justifyContent:"flex-start"},children:r.value})},{field:"cost",headerName:"Cost",width:100,align:"right",headerAlign:"right"},{field:"price",headerName:"Price",width:100,align:"right",headerAlign:"right",renderCell:r=>x(r.value).format("0,0.00")},{field:"valuation",headerName:"Valuation",width:100,align:"right",headerAlign:"right",renderCell:r=>{const u=r.row.cost,j=r.row.quantity;return x(u*j).format("0,0.00")}},{field:"quantity",headerName:"Qty",width:90,align:"right",headerAlign:"right",valueGetter:r=>parseFloat(r),renderCell:r=>t.jsx(b,{variant:"text",color:"default",fullWidth:!0,sx:{textAlign:"right",fontWeight:"bold",justifyContent:"flex-end"},underline:"hover",onClick:()=>h(r.row,"qty"),children:x(r.value).format("0,0.00")})},{field:"action",headerName:"Action",align:"center",headerAlign:"center",width:200,renderCell:r=>t.jsxs(g,{sx:{display:"flex",gap:1,justifyContent:"center",alignItems:"center",flexWrap:"nowrap"},children:[t.jsx(p,{href:`/product/${r.row.batch_id}/barcode`,children:t.jsx(Z,{color:"primary"})}),t.jsx(p,{href:`/product/${r.row.batch_id}/barcode-v2`,children:t.jsx(J,{size:24,stroke:"#1976d2"})}),t.jsx(p,{href:`/quantity/${r.row.stock_id}/log`,children:t.jsx(D,{color:"primary"})})]})},{field:"is_featured",headerName:"Featured",headerAlign:"center",renderCell:r=>r.value===1?t.jsx(g,{display:"flex",justifyContent:"center",alignItems:"center",style:{height:"100%"},children:t.jsx(tt,{color:"primary"})}):t.jsx(g,{display:"flex",justifyContent:"center",alignItems:"center",style:{height:"100%"},children:t.jsx(et,{color:"primary"})})}];function Ze({products:h,stores:r,contacts:u}){const j=X(),C=K(j.breakpoints.down("sm"));F().props.auth.user;const[M,S]=o.useState(!1),[A,P]=o.useState(!1),[v,N]=o.useState(!1),[s,y]=o.useState(h),[q,it]=o.useState(u),[L,B]=o.useState(0),[ot,at]=o.useState(!1),[l,z]=o.useState(()=>({store:0,status:new URLSearchParams(window.location.search).get("status")||1,search_query:"",alert_quantity:"",per_page:100,contact_id:""})),_=(e,i)=>{N(e),i==="batch"&&S(!0),i==="qty"&&P(!0)},m=(e=window.location.pathname)=>{const i={preserveState:!0,preserveScroll:!0,only:["products"],onSuccess:n=>{y(n.props.products)}};V.get(e,{...l},i)},c=e=>{if(e?.target){const{name:i,value:n}=e.target;z(T=>({...T,[i]:n}))}else z(i=>({...i,contact_id:e?.id}))};o.useEffect(()=>{const e=Object.values(s.data).reduce((i,n)=>i+n.cost*n.quantity,0);B(e)},[s]);const[k,O]=o.useState(!1);return o.useEffect(()=>{if(!k){O(!0);return}m(window.location.pathname)},[l]),t.jsxs(H,{children:[t.jsx(W,{title:"Products"}),t.jsxs(a,{container:!0,spacing:1,alignItems:"center",children:[t.jsxs(a,{size:12,spacing:1,container:!0,alignItems:"center",justifyContent:{xs:"center",sm:"end"},children:[t.jsx(a,{size:{xs:12,sm:3,md:2},children:t.jsxs(f,{value:l.store,label:"Store",onChange:c,required:!0,name:"store",select:!0,fullWidth:!0,margin:"dense",size:"small",children:[t.jsx(d,{value:0,children:"All"}),r.map(e=>t.jsx(d,{value:e.id,children:e.name},e.id))]})}),t.jsx(a,{size:{xs:12,sm:4,md:3},children:t.jsx(R,{fullWidth:!0,placeholder:"Select a supplier...",styles:{control:(e,i)=>({...e,height:"40px"}),menuPortal:e=>({...e,zIndex:9999})},options:u,onChange:e=>c(e),isClearable:!0,getOptionLabel:e=>e.name+" | "+e.balance,getOptionValue:e=>e.id,menuPortalTarget:document.body})}),t.jsx(a,{size:{xs:6,sm:2},children:t.jsxs(f,{value:l.status,label:"Status",size:"small",onChange:c,required:!0,name:"status",fullWidth:!0,select:!0,margin:"dense",children:[t.jsx(d,{value:1,children:"Active"}),t.jsx(d,{value:0,children:"Inactive"}),t.jsx(d,{value:"alert",children:"Alert"}),t.jsx(d,{value:"out_of_stock",children:"Out of Stock"})]})}),t.jsx(a,{size:{xs:6,sm:2,md:2},children:t.jsx(f,{value:l.alert_quantity,label:"Alert Qty",size:"small",onChange:c,placeholder:"Alert Qty",name:"alert_quantity",type:"number",slotProps:{inputLabel:{shrink:!0}}})}),t.jsx(a,{size:{xs:12,sm:3,md:3},children:t.jsx(f,{fullWidth:!0,name:"search_query",label:"Search",size:"small",variant:"outlined",value:l.search_query,onChange:c,placeholder:"Barcode or Name",onFocus:e=>{e.target.select()},onKeyDown:e=>{e.key==="Enter"&&(e.preventDefault(),m(window.location.pathname))},slotProps:{inputLabel:{shrink:!0}}})}),t.jsx(a,{size:{xs:9,sm:3,md:2},children:t.jsx(p,{href:"/products/create",children:t.jsx(b,{size:"small",variant:"contained",color:"success",startIcon:t.jsx(Q,{}),fullWidth:!0,sx:{minWidth:{xs:"100px",sm:"100px"}},children:"Add Product"})})})]}),!C&&t.jsx(g,{className:"py-2 w-full",sx:{display:"grid",gridTemplateColumns:"1fr",height:"calc(100vh - 290px)"},children:t.jsx(Y,{rows:s.data,columns:rt(_),getRowId:e=>e.id+e.batch_number+e.store_id,slotProps:{toolbar:{showQuickFilter:!0}},initialState:{columns:{columnVisibilityModel:{cost:!1,created_at:!1}}},showToolbar:!0,hideFooter:!0})}),C&&t.jsx(U,{products:s.data,handleProductEdit:_}),t.jsxs(a,{size:12,spacing:2,container:!0,justifyContent:"end",alignItems:"center",children:[t.jsx(I,{size:"large",label:"Total results : "+s.total,color:"primary"}),t.jsx(I,{size:"large",label:"Total valuation : "+x(L).format("0,00.00"),color:"primary"}),t.jsx($,{refreshTable:m,setSearchTerms:z,searchTerms:l,data:s})]})]}),t.jsx(E,{batchModalOpen:M,setBatchModalOpen:S,selectedBatch:v,products:s.data,setProducts:y,refreshProducts:m,selectedProduct:v,contacts:q}),t.jsx(G,{modalOpen:A,setModalOpen:P,selectedStock:v,products:s.data,setProducts:y,refreshProducts:m,stores:r})]})}export{Ze as default};
